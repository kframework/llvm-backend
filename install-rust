#!/bin/sh -e
curl -L https://static.rust-lang.org/dist/rustc-1.33.0-src.tar.gz -o rustc-src.tar.gz
curl -L https://github.com/rust-lang/cargo/archive/0.34.0.tar.gz -o cargo.tar.gz
sha512sum -c rust-checksum

tar xvf rustc-src.tar.gz
cd rustc-1.33.0-src
./configure --llvm-root=/usr/lib/llvm-6.0 --enable-llvm-link-shared
./x.py install
cd ..
rm -rf rustc-1.33.0-src rustc-src.tar.gz

apt-get install -y cargo
tar xvf cargo.tar.gz
cd cargo-0.34.0
cargo build --release
cargo install --path . --root /usr/local
apt-get remove -y cargo rustc
cd ..
rm -rf cargo.tar.gz cargo-0.34.0
